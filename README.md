# Trace-n-Seq
Repository containing the complete SMART seq two Trace n Seq analysis workflow, including raw and filtered objects, quality control scripts, reference based neuronal annotation, Seurat and SingleCellExperiment pipelines, and code to generate all figures for healthy, pancreatitis and cancer neuron datasets.


4. combine_counts.R

Purpose:
Combines all per-cell *_counts.txt files generated by htseq-count into a single expression matrix for downstream analysis.

What it does:

Scans a dataset directory for cell folders.

Identifies each cellâ€™s aligned_STAR/<CELL_ID>_counts.txt file.

Reads all count files and merges them into a gene-by-cell matrix.

Assigns cell IDs as column names.

Saves the final combined matrix as <dataset>_combined_counts.csv.

Folder structure expected:

/path/to/project/ALIGNMENT/
    DATASET_NAME/
        CELL_ID_1/fastq/aligned_STAR/CELL_ID_1_counts.txt
        CELL_ID_2/fastq/aligned_STAR/CELL_ID_2_counts.txt
        ...


How to run:

Rscript combine_counts.R


Output:

/path/to/project/ALIGNMENT/DATASET_NAME_combined_counts.csv


This matrix is ready for import into Seurat, SingleCellExperiment, or other analysis workflows.
